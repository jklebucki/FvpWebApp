
    SELECT FVNAGLID AS DOKID, 'FV' TYPDOK, KONTRAHID, CZYZPAR, KONTRAHNAZWA, ULICANR, KODPOCZTOWY, MIEJSCOWOSC, nvl(KODKRAJU,'-') AS KODKRAJU, nvl(NIP,'-') AS NIP, FIRMA, NRDOK, DATASPRZEDAZY, DATA, NETTO, BRUTTO, VAT, NETTO_A, BRUTTO_A, VAT_A,
        NETTO_B, BRUTTO_B, VAT_B, NETTO_C, BRUTTO_C, VAT_C, NETTO_D, BRUTTO_D, VAT_D, NETTO_E, BRUTTO_E, VAT_E, NETTO_F, BRUTTO_F, VAT_F, NETTO_Z, BRUTTO_Z, VAT_Z, NETTO_NP, BRUTTO_NP, VAT_NP
    FROM
        (SELECT F.FVNAGLID, F.NRDOK AS NRDOK, nvl(KODKRAJU,'') AS KODKRAJU, TO_CHAR(F.Data,'yyyy-mm-dd HH24:MI:SS') DATA, ND.DATASPRZEDAZY,
            F.KONTRAHID, F.KONTRAHNAZWA, nvl(F.KONTRAHNIP,'') AS NIP, nvl(KONTRAHKODPOCZT,'-') AS KODPOCZTOWY, nvl(KONTRAHMIEJSCOWOSC,'-') AS MIEJSCOWOSC, nvl(KONTRAHULICANR,'-') AS ULICANR, FAKTURAZPARAGONU AS CZYZPAR, nvl(FIRMA,-1) AS FIRMA,
            (S.BRUTTO_NP-S.VAT_NP) AS NETTO_NP, S.VAT_NP, S.BRUTTO_NP,
            (S.BRUTTO_Z-S.VAT_Z) AS NETTO_Z, S.VAT_Z, S.BRUTTO_Z,
            (S.BRUTTO_F-S.VAT_F) AS NETTO_F, S.VAT_F, S.BRUTTO_F,
            (S.BRUTTO_E-S.VAT_E) AS NETTO_E, S.VAT_E, S.BRUTTO_E,
            (S.BRUTTO_D-S.VAT_D) AS NETTO_D, S.VAT_D, S.BRUTTO_D,
            (S.BRUTTO_C-S.VAT_C) AS NETTO_C, S.VAT_C, S.BRUTTO_C,
            (S.BRUTTO_B-S.VAT_B) AS NETTO_B, S.VAT_B, S.BRUTTO_B,
            (S.BRUTTO_A-S.VAT_A) AS NETTO_A, S.VAT_A, S.BRUTTO_A,
            (S.BRUTTO_A-S.VAT_A)+(S.BRUTTO_B-S.VAT_B)+(S.BRUTTO_C-S.VAT_C)+(S.BRUTTO_D-S.VAT_D)+(S.BRUTTO_E-S.VAT_E)+(S.BRUTTO_F-S.VAT_F)+(S.BRUTTO_Z-S.VAT_Z)+(S.BRUTTO_NP-S.VAT_NP) NETTO,
            (S.VAT_A+S.VAT_B+S.VAT_C+S.VAT_D+S.VAT_E+S.VAT_F+S.VAT_Z+S.VAT_NP) VAT,
            (S.BRUTTO_A+S.BRUTTO_B+S.BRUTTO_C+S.BRUTTO_D+S.BRUTTO_E+S.BRUTTO_F+S.BRUTTO_Z+S.BRUTTO_NP) BRUTTO
        FROM FVNAGL F, (SELECT FVNAGLID,
                sum(nvl(DECODE(VATSYMBOL,128,WARTOSCVAT),0)) AS VAT_NP,
                sum(nvl(DECODE(VATSYMBOL,128,WARTOSCBRUTTO),0)) AS BRUTTO_NP,
                sum(nvl(DECODE(VATSYMBOL,64,WARTOSCVAT),0)) AS VAT_Z,
                sum(nvl(DECODE(VATSYMBOL,64,WARTOSCBRUTTO),0)) AS BRUTTO_Z,
                sum(nvl(DECODE(VATSYMBOL,32,WARTOSCVAT),0)) AS VAT_F,
                sum(nvl(DECODE(VATSYMBOL,32,WARTOSCBRUTTO),0)) AS BRUTTO_F,
                sum(nvl(DECODE(VATSYMBOL,16,WARTOSCVAT),0)) AS VAT_E,
                sum(nvl(DECODE(VATSYMBOL,16,WARTOSCBRUTTO),0)) AS BRUTTO_E,
                sum(nvl(DECODE(VATSYMBOL,8,WARTOSCVAT),0)) AS VAT_D,
                sum(nvl(DECODE(VATSYMBOL,8,WARTOSCBRUTTO),0)) AS BRUTTO_D,
                sum(nvl(DECODE(VATSYMBOL,4,WARTOSCVAT),0)) AS VAT_C,
                sum(nvl(DECODE(VATSYMBOL,4,WARTOSCBRUTTO),0)) AS BRUTTO_C,
                sum(nvl(DECODE(VATSYMBOL,2,WARTOSCVAT),0)) AS VAT_B,
                sum(nvl(DECODE(VATSYMBOL,2,WARTOSCBRUTTO),0)) AS BRUTTO_B,
                sum(nvl(DECODE(VATSYMBOL,1,WARTOSCVAT),0)) AS VAT_A,
                sum(nvl(DECODE(VATSYMBOL,1,WARTOSCBRUTTO),0)) AS BRUTTO_A
            FROM FVSTAWKIVAT
            GROUP BY FVNAGLID) S,
            (SELECT ID, DATA, DATASPRZEDAZY, NRDOK
            FROM NAGLDOKROZCH) ND
        WHERE  F.DATA BETWEEN TO_DATE('dataOd 00:00:00',  'YYYY-MM-DD HH24:MI:SS') 
AND TO_DATE('dataDo 23:59:59',  'YYYY-MM-DD HH24:MI:SS')
            AND F.FVNAGLID = S.FVNAGLID AND ND.ID=F.FVNAGLID
        ORDER BY F.DATA)
UNION ALL
    SELECT FVKNAGLID AS DOKID, 'FVK' TYPDOK, KONTRAHID, CZYZPAR, KONTRAHNAZWA, ULICANR, KODPOCZTOWY, MIEJSCOWOSC, nvl(KODKRAJU,'-') AS KODKRAJU, nvl(NIP,'-') AS NIP, FIRMA, NRDOK, DATASPRZEDAZY, DATA, NETTO, BRUTTO, VAT, NETTO_A, BRUTTO_A, VAT_A,
        NETTO_B, BRUTTO_B, VAT_B, NETTO_C, BRUTTO_C, VAT_C, NETTO_D, BRUTTO_D, VAT_D, NETTO_E, BRUTTO_E, VAT_E, NETTO_F, BRUTTO_F, VAT_F, NETTO_Z, BRUTTO_Z, VAT_Z, NETTO_NP, BRUTTO_NP, VAT_NP
    FROM(SELECT F.FVKNAGLID, F.NRDOK AS NRDOK, nvl(KODKRAJU,'') AS KODKRAJU, TO_CHAR(F.Data,'yyyy-mm-dd HH24:MI:SS') DATA, ND.DATASPRZEDAZY,
            FV.KONTRAHID, FV.KONTRAHNAZWA, nvl(FV.KONTRAHNIP,'') AS NIP, nvl(KONTRAHKODPOCZT,'-') AS KODPOCZTOWY, nvl(KONTRAHMIEJSCOWOSC,'-') AS MIEJSCOWOSC, nvl(KONTRAHULICANR,'-') AS ULICANR, FAKTURAZPARAGONU AS CZYZPAR, nvl(FIRMA,-1) AS FIRMA,
            (S.BRUTTO_A-S.VAT_A) AS NETTO_A, S.VAT_A, S.BRUTTO_A,
            (S.BRUTTO_B-S.VAT_B) AS NETTO_B, S.VAT_B, S.BRUTTO_B,
            (S.BRUTTO_C-S.VAT_C) AS NETTO_C, S.VAT_C, S.BRUTTO_C,
            (S.BRUTTO_D-S.VAT_D) AS NETTO_D, S.VAT_D, S.BRUTTO_D,
            (S.BRUTTO_E-S.VAT_E) AS NETTO_E, S.VAT_E, S.BRUTTO_E,
            (S.BRUTTO_F-S.VAT_F) AS NETTO_F, S.VAT_F, S.BRUTTO_F,
            (S.BRUTTO_Z-S.VAT_Z) AS NETTO_Z, S.VAT_Z, S.BRUTTO_Z,
            (S.BRUTTO_NP-S.VAT_NP) AS NETTO_NP, S.VAT_NP, S.BRUTTO_NP,
            (S.BRUTTO_NP-S.VAT_NP)+(S.BRUTTO_C-S.VAT_C)+(S.BRUTTO_B-S.VAT_B)+(S.BRUTTO_A-S.VAT_A)+(S.BRUTTO_D-S.VAT_D)+(S.BRUTTO_E-S.VAT_E)+(S.BRUTTO_F-S.VAT_F)+(S.BRUTTO_Z-S.VAT_Z) NETTO,
            (S.VAT_A+S.VAT_B+S.VAT_C+S.VAT_D+S.VAT_E+S.VAT_F+S.VAT_Z+S.VAT_NP) VAT,
            (S.BRUTTO_A+S.BRUTTO_B+S.BRUTTO_C+S.BRUTTO_D+S.BRUTTO_E+S.BRUTTO_F+S.BRUTTO_Z+S.BRUTTO_NP) BRUTTO
        FROM FVKNAGL F,
            (SELECT FVKNAGLID,
                sum(nvl(DECODE(VATSYMBOL,128,WARTOSCVATPO-WARTOSCVATPRZED),0)) AS VAT_NP,
                sum(nvl(DECODE(VATSYMBOL,128,WARTOSCBRUTTOPO-WARTOSCBRUTTOPRZED),0)) AS BRUTTO_NP,
                sum(nvl(DECODE(VATSYMBOL,64,WARTOSCVATPO-WARTOSCVATPRZED),0)) AS VAT_Z,
                sum(nvl(DECODE(VATSYMBOL,64,WARTOSCBRUTTOPO-WARTOSCBRUTTOPRZED),0)) AS BRUTTO_Z,
                sum(nvl(DECODE(VATSYMBOL,32,WARTOSCVATPO-WARTOSCVATPRZED),0)) AS VAT_F,
                sum(nvl(DECODE(VATSYMBOL,32,WARTOSCBRUTTOPO-WARTOSCBRUTTOPRZED),0)) AS BRUTTO_F,
                sum(nvl(DECODE(VATSYMBOL,16,WARTOSCVATPO-WARTOSCVATPRZED),0)) AS VAT_E,
                sum(nvl(DECODE(VATSYMBOL,16,WARTOSCBRUTTOPO-WARTOSCBRUTTOPRZED),0)) AS BRUTTO_E,
                sum(nvl(DECODE(VATSYMBOL,8,WARTOSCVATPO-WARTOSCVATPRZED),0)) AS VAT_D,
                sum(nvl(DECODE(VATSYMBOL,8,WARTOSCBRUTTOPO-WARTOSCBRUTTOPRZED),0)) AS BRUTTO_D,
                sum(nvl(DECODE(VATSYMBOL,4,WARTOSCVATPO-WARTOSCVATPRZED),0)) AS VAT_C,
                sum(nvl(DECODE(VATSYMBOL,4,WARTOSCBRUTTOPO-WARTOSCBRUTTOPRZED),0)) AS BRUTTO_C,
                sum(nvl(DECODE(VATSYMBOL,2,WARTOSCVATPO-WARTOSCVATPRZED),0)) AS VAT_B,
                sum(nvl(DECODE(VATSYMBOL,2,WARTOSCBRUTTOPO-WARTOSCBRUTTOPRZED),0)) AS BRUTTO_B,
                sum(nvl(DECODE(VATSYMBOL,1,WARTOSCVATPO-WARTOSCVATPRZED),0)) AS VAT_A,
                sum(nvl(DECODE(VATSYMBOL,1,WARTOSCBRUTTOPO-WARTOSCBRUTTOPRZED),0)) AS BRUTTO_A
            FROM FVKSTAWKIVAT
            GROUP BY FVKNAGLID) S, FVNAGL FV, (SELECT ID, DATA, DATASPRZEDAZY, NRDOK
            FROM NAGLDOKROZCH) ND
        WHERE  F.DATA BETWEEN TO_DATE('dataOd 00:00:00',  'YYYY-MM-DD HH24:MI:SS') 
AND TO_DATE('dataDo 23:59:59',  'YYYY-MM-DD HH24:MI:SS')
            AND F.FVKNAGLID = S.FVKNAGLID AND F.DOTYCZYDOKID = FV.FVNAGLID AND ND.ID=F.FVKNAGLID
        ORDER BY F.DATA)